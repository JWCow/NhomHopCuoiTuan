<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Message Generator - C√¥ng c·ª• t·∫°o tin nh·∫Øn</title>

    <!-- Primary Meta Tags -->
    <meta name="title" content="Message Generator - C√¥ng c·ª• t·∫°o tin nh·∫Øn th√¥ng b√°o">
    <meta name="description" content="T·∫°o tin nh·∫Øn th√¥ng b√°o cho bu·ªïi nh√≥m h·ªçp cu·ªëi tu·∫ßn m·ªôt c√°ch nhanh ch√≥ng v√† chuy√™n nghi·ªáp. Giao di·ªán hi·ªán ƒë·∫°i, h·ªó tr·ª£ ti·∫øng Vi·ªát v√† ti·∫øng Anh.">
    <meta name="keywords" content="message generator, tin nh·∫Øn th√¥ng b√°o, nh√≥m h·ªçp cu·ªëi tu·∫ßn, c√¥ng c·ª• t·∫°o tin nh·∫Øn">
    <meta name="author" content="JWCow">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://nhomhop-messenger.vercel.app/">
    <meta property="og:title" content="Message Generator - C√¥ng c·ª• t·∫°o tin nh·∫Øn th√¥ng b√°o">
    <meta property="og:description" content="T·∫°o tin nh·∫Øn th√¥ng b√°o cho bu·ªïi nh√≥m h·ªçp cu·ªëi tu·∫ßn m·ªôt c√°ch nhanh ch√≥ng v√† chuy√™n nghi·ªáp. Giao di·ªán hi·ªán ƒë·∫°i, h·ªó tr·ª£ ti·∫øng Vi·ªát v√† ti·∫øng Anh.">
    <meta property="og:image" content="https://raw.githubusercontent.com/JWCow/NhomHopCuoiTuan/main/preview.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:locale" content="vi_VN">
    <meta property="og:site_name" content="Message Generator">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://nhomhop-messenger.vercel.app/">
    <meta property="twitter:title" content="Message Generator - C√¥ng c·ª• t·∫°o tin nh·∫Øn th√¥ng b√°o">
    <meta property="twitter:description" content="T·∫°o tin nh·∫Øn th√¥ng b√°o cho bu·ªïi nh√≥m h·ªçp cu·ªëi tu·∫ßn m·ªôt c√°ch nhanh ch√≥ng v√† chuy√™n nghi·ªáp. Giao di·ªán hi·ªán ƒë·∫°i, h·ªó tr·ª£ ti·∫øng Vi·ªát v√† ti·∫øng Anh.">
    <meta property="twitter:image" content="https://raw.githubusercontent.com/JWCow/NhomHopCuoiTuan/main/preview.png">
    <meta name="twitter:creator" content="@JWCow">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAABZklEQVR4nO2WTU7DQAyFPxALlkgsuQ5HgBMgTsB1YNdFz8CCA3AFVAgJiR07UPcMbNiAEBJC/EQd1VGVSTp/naEgYSlW6sl7z2OPxzDwz1kJ3AG/UgZRvb+xKKfAK/Cj+gQ2+xR/AH5bRD5UH/sQvwS+O0QWugdWY4uvA99L4t/AA3CuWgEPwEeL0Hss8XPga4n4G3DTUbsJvLeIXcYQv2wRX6h3HfVbwIxoZ6GdHwEfLeIzYK+H1h7w3NJBcAcugI8WgVdgO4DmdsD7zIFzYNpS/AXYCay/AzwZHUyBs1B9PwKTlrbPgLVIXqvAo9HFBBi7Fh8BYwOcRDZZ6tKxwcEEGLkUHwHPBjCNZGKpK8PBGBi6Eh8Cj8bLSYSNZ6lrw8UIOHAhPjCAH0DfkUmXrg03+8C7AXz1uVQMcKJ6N8DvPu/zAJgbwEff22sAE9VbKGcxjFeBW+DHVwf/gRXjD5NrqoP/j1OGAAAAAElFTkSuQmCC">

    <style>
        :root {
            --bg-color: #1a1a1a;
            --text-color: #e0e0e0;
            --input-bg: #2d2d2d;
            --input-border: #404040;
            --button-bg: #4a4a8c;
            --button-hover: #5a5aa6;
            --preview-bg: #2a2a2a;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
        }

        input, select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--input-border);
            border-radius: 4px;
            background-color: var(--input-bg);
            color: var(--text-color);
            font-size: 14px;
        }

        button {
            background-color: var(--button-bg);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            width: 100%;
            margin: 10px 0;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: var(--button-hover);
        }

        .preview {
            background-color: var(--preview-bg);
            padding: 15px;
            border-radius: 4px;
            margin-top: 20px;
            white-space: pre-wrap;
            min-height: 200px;
        }

        .title {
            text-align: center;
            margin-bottom: 30px;
            font-size: 24px;
        }

        .language-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: var(--button-bg);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            transition: background-color 0.3s;
            border: none;
            font-size: 14px;
            width: auto;
        }

        .language-toggle:hover {
            background-color: var(--button-hover);
        }

        /* Remove the custom outline input styles */
        .outline-input-container {
            position: relative;
            width: 100%;
        }

        .outline-input {
            width: 100%;
            cursor: pointer;
        }

        /* Remove the custom arrow */
        .outline-input-container::after {
            display: none;
        }

        /* Style for datalist options */
        input::-webkit-calendar-picker-indicator {
            opacity: 0;
            cursor: pointer;
            position: absolute;
            right: 0;
            top: 0;
            width: 100%;
            height: 100%;
        }

        /* Highlight matching text */
        .highlight {
            background-color: var(--button-bg);
            color: white;
            padding: 0 2px;
            border-radius: 2px;
        }

        .congregation-input {
            display: flex;
            gap: 10px;
        }

        .congregation-input select,
        .congregation-input input {
            flex: 1;
        }

        datalist {
            max-height: 200px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <button class="language-toggle" onclick="toggleLanguage()">üåê English</button>
    <div class="container">
        <h1 class="title" data-vi="‚ú® T·∫°o Th√¥ng B√°o DVCC" data-en="‚ú® Public Talk Announcer">‚ú® T·∫°o Th√¥ng B√°o DVCC</h1>
        
        <div class="form-group">
            <label data-vi="üìÖ Ng√†y:" data-en="üìÖ Date:">üìÖ Ng√†y:</label>
            <input type="date" id="date" required>
        </div>

        <div class="form-group">
            <label data-vi="üéµ B√†i h√°t m·ªü ƒë·∫ßu s·ªë:" data-en="üéµ Opening Song Number:">üéµ B√†i h√°t m·ªü ƒë·∫ßu s·ªë:</label>
            <input type="number" id="songNumber" required>
        </div>

        <div class="form-group">
            <label data-vi="üìñ S·ªë D√†n B√†i:" data-en="üìñ Outline Number:">üìñ S·ªë D√†n B√†i:</label>
            <input type="text" 
                   id="outlineSearch" 
                   list="outlineList"
                   placeholder="T√¨m s·ªë d√†n b√†i..."
                   onchange="handleOutlineSearch(this.value)"
                   required>
            <input type="hidden" id="outlineNumber">
            <datalist id="outlineList">
                <!-- Will be populated by JavaScript -->
            </datalist>
        </div>

        <div class="form-group">
            <label data-vi="üìñ B√†i DVCC c√≥ t·ª±a ƒë·ªÅ:" data-en="üìñ Public Talk Title:">üìñ B√†i DVCC c√≥ t·ª±a ƒë·ªÅ:</label>
            <input type="text" 
                   id="talkTitle" 
                   readonly 
                   required>
        </div>

        <div class="form-group">
            <label data-vi="üé§ Di·ªÖn gi·∫£:" data-en="üé§ Speaker:">üé§ Di·ªÖn gi·∫£:</label>
            <input type="text" id="speaker" required>
        </div>

        <div class="form-group">
            <label data-vi="üèõÔ∏è H·ªôi th√°nh:" data-en="üèõÔ∏è Congregation:">üèõÔ∏è H·ªôi th√°nh:</label>
            <div class="congregation-input">
                <select id="congregationSelect" onchange="handleCongregationChange(this.value)">
                    <option value="">Ch·ªçn h·ªôi th√°nh</option>
                    <option value="custom" data-vi="T√πy ch·ªânh" data-en="Custom">T√πy ch·ªânh</option>
                    <!-- Will be populated by JavaScript -->
                </select>
                <input type="text" 
                       id="congregation" 
                       style="display: none;"
                       placeholder="Nh·∫≠p t√™n h·ªôi th√°nh"
                       required>
            </div>
        </div>

        <div class="form-group">
            <label data-vi="üôè C·∫ßu nguy·ªán k·∫øt th√∫c?:" data-en="üôè Closing Prayer?:">üôè C·∫ßu nguy·ªán k·∫øt th√∫c?:</label>
            <select id="prayerConfirm">
                <option value="C√≥" data-vi="C√≥" data-en="Yes">C√≥</option>
                <option value="Kh√¥ng" data-vi="Kh√¥ng" data-en="No">Kh√¥ng</option>
            </select>
        </div>

        <div class="form-group">
            <label data-vi="üìñ S·ªë D√†n B√†i tu·∫ßn t·ªõi:" data-en="üìñ Next Week's Outline Number:">üìñ S·ªë D√†n B√†i tu·∫ßn t·ªõi:</label>
            <input type="text" 
                   id="nextOutlineSearch" 
                   list="nextOutlineList"
                   placeholder="T√¨m s·ªë d√†n b√†i..."
                   onchange="handleNextOutlineSearch(this.value)"
                   required>
            <input type="hidden" id="nextOutlineNumber">
            <datalist id="nextOutlineList">
                <!-- Will be populated by JavaScript -->
            </datalist>
        </div>

        <div class="form-group">
            <label data-vi="üìñ B√†i DVCC tu·∫ßn t·ªõi:" data-en="üìñ Next Week's Talk Title:">üìñ B√†i DVCC tu·∫ßn t·ªõi:</label>
            <input type="text" 
                   id="nextTalkTitle" 
                   readonly>
        </div>

        <button onclick="generateMessage()" data-vi="‚ú® T·∫°o tin nh·∫Øn" data-en="‚ú® Generate Message">‚ú® T·∫°o tin nh·∫Øn</button>
        <button onclick="copyToClipboard()" data-vi="üìã Sao ch√©p tin nh·∫Øn" data-en="üìã Copy Message">üìã Sao ch√©p tin nh·∫Øn</button>

        <div class="preview" id="preview"></div>
    </div>

    <script>
        let currentLanguage = 'vi';
        const translations = {
            vi: {
                greeting: 'üëã Ch√†o c√°c anh!',
                meetingDate: 'üìÖ Nh√≥m h·ªçp ng√†y',
                has: 'c√≥',
                openingSong: 'üéµ B√†i h√°t m·ªü ƒë·∫ßu s·ªë:',
                talkTitle: 'üìñ B√†i DVCC c√≥ t·ª±a ƒë·ªÅ:',
                speaker: 'üé§ Di·ªÖn gi·∫£:',
                congregation: 'üèõÔ∏è H·ªôi th√°nh:',
                closingPrayer: 'üôè Di·ªÖn gi·∫£ s·∫Ω c·∫ßu nguy·ªán k·∫øt th√∫c:',
                nextWeekTalk: 'üìñ B√†i DVCC cho th·ª© b·∫£y tu·∫ßn t·ªõi c√≥ t·ª±a ƒë·ªÅ:',
                thanks: 'üôè C·∫£m ∆°n c√°c anh.',
                copyAlert: 'Vui l√≤ng t·∫°o tin nh·∫Øn tr∆∞·ªõc khi sao ch√©p!',
                copySuccess: 'ƒê√£ sao ch√©p tin nh·∫Øn v√†o clipboard!',
                copyError: 'Kh√¥ng th·ªÉ sao ch√©p tin nh·∫Øn. Vui l√≤ng th·ª≠ l·∫°i!'
            },
            en: {
                greeting: 'üëã Hello brothers!',
                meetingDate: 'üìÖ Meeting on',
                has: 'includes',
                openingSong: 'üéµ Opening Song Number:',
                talkTitle: 'üìñ Public Talk Title:',
                speaker: 'üé§ Speaker:',
                congregation: 'üèõÔ∏è Congregation:',
                closingPrayer: 'üôè Speaker will give closing prayer:',
                nextWeekTalk: 'üìñ Next Saturday\'s Public Talk Title:',
                thanks: 'üôè Thank you brothers.',
                copyAlert: 'Please generate a message before copying!',
                copySuccess: 'Message copied to clipboard!',
                copyError: 'Could not copy message. Please try again!'
            }
        };

        function toggleLanguage() {
            currentLanguage = currentLanguage === 'vi' ? 'en' : 'vi';
            const toggle = document.querySelector('.language-toggle');
            toggle.textContent = currentLanguage === 'vi' ? 'üåê English' : 'üåê Ti·∫øng Vi·ªát';
            
            // Update all labels and buttons
            document.querySelectorAll('[data-vi]').forEach(element => {
                element.textContent = element.getAttribute(`data-${currentLanguage}`);
            });

            // Update placeholders
            document.getElementById('congregation').placeholder = 
                currentLanguage === 'vi' ? 'Nh·∫≠p t√™n h·ªôi th√°nh' : 'Enter congregation name';
            document.getElementById('outlineSearch').placeholder = 
                currentLanguage === 'vi' ? 'T√¨m s·ªë d√†n b√†i...' : 'Search outline number...';
            document.getElementById('nextOutlineSearch').placeholder = 
                currentLanguage === 'vi' ? 'T√¨m s·ªë d√†n b√†i...' : 'Search outline number...';

            // Update select options
            document.querySelectorAll('option[data-vi]').forEach(option => {
                option.textContent = option.getAttribute(`data-${currentLanguage}`);
            });

            // Regenerate message if preview exists
            const preview = document.getElementById('preview');
            if (preview.textContent) {
                generateMessage();
            }
        }

        function formatDate(date) {
            const [year, month, day] = date.split('-');
            return `${day}/${month}/${year}`;
        }

        function generateMessage() {
            const t = translations[currentLanguage];
            const date = formatDate(document.getElementById('date').value);
            const songNumber = document.getElementById('songNumber').value;
            const outlineNumber = document.getElementById('outlineNumber').value;
            const talkTitle = document.getElementById('talkTitle').value;
            const speaker = document.getElementById('speaker').value;
            const congregation = document.getElementById('congregation').value;
            const prayerConfirm = document.getElementById('prayerConfirm').value;
            const nextOutlineNumber = document.getElementById('nextOutlineNumber').value;
            const nextTalkTitle = document.getElementById('nextTalkTitle').value;

            const prayerEmoji = prayerConfirm === 'C√≥' ? '‚úÖ' : '‚ùå';
            const prayerText = currentLanguage === 'vi' ? prayerConfirm : (prayerConfirm === 'C√≥' ? 'Yes' : 'No');

            const message = `${t.greeting}

${t.meetingDate} ${date} ${t.has}:

${t.openingSong} ${songNumber}

${t.talkTitle}
"${outlineNumber} ${talkTitle}"

${t.speaker} ${speaker}
${t.congregation} ${congregation}
${t.closingPrayer} ${prayerText} ${prayerEmoji}

${t.nextWeekTalk}
"${nextOutlineNumber} ${nextTalkTitle}"

${t.thanks}`;

            document.getElementById('preview').textContent = message;
        }

        function copyToClipboard() {
            const preview = document.getElementById('preview');
            const text = preview.textContent;
            const t = translations[currentLanguage];
            
            if (!text) {
                alert(t.copyAlert);
                return;
            }

            navigator.clipboard.writeText(text).then(() => {
                alert(t.copySuccess);
            }).catch(err => {
                console.error('Copy failed:', err);
                alert(t.copyError);
            });
        }

        // Set today's date as default
        document.getElementById('date').valueAsDate = new Date();

        let outlines = []; // Will store the outline database
        let congregations = []; // Will store the congregations database

        // Function to load the outline database
        async function loadOutlines() {
            try {
                const response = await fetch('outlines.json');
                const data = await response.json();
                outlines = data.outlines;
                populateOutlinesList();
            } catch (error) {
                console.error('Error loading outlines:', error);
            }
        }

        // Function to load the congregations database
        async function loadCongregations() {
            try {
                const response = await fetch('congregations.json');
                const data = await response.json();
                congregations = data.congregations;
                populateCongregationsList();
            } catch (error) {
                console.error('Error loading congregations:', error);
            }
        }

        // Function to populate the outline selects
        function populateOutlinesList() {
            const outlineList = document.getElementById('outlineList');
            const nextOutlineList = document.getElementById('nextOutlineList');
            
            // Clear existing options
            outlineList.innerHTML = '';
            nextOutlineList.innerHTML = '';
            
            // Add outline options
            outlines.forEach(outline => {
                // For the first outline datalist
                const option = document.createElement('option');
                option.value = outline.number;
                option.textContent = `${outline.number.padStart(3, '0')} - ${outline.title}`;
                outlineList.appendChild(option);
                
                // For the next week's outline datalist
                const nextOption = document.createElement('option');
                nextOption.value = outline.number;
                nextOption.textContent = `${outline.number.padStart(3, '0')} - ${outline.title}`;
                nextOutlineList.appendChild(nextOption);
            });
        }

        // Function to populate the congregation select
        function populateCongregationsList() {
            const congregationSelect = document.getElementById('congregationSelect');
            
            // Keep the first two options (placeholder and custom)
            const placeholder = congregationSelect.querySelector('option[value=""]');
            const customOption = congregationSelect.querySelector('option[value="custom"]');
            
            // Clear all options
            congregationSelect.innerHTML = '';
            
            // Add back placeholder and custom options
            if (placeholder) congregationSelect.appendChild(placeholder);
            if (customOption) congregationSelect.appendChild(customOption);
            
            // Add congregation options
            congregations.forEach(congregation => {
                const option = document.createElement('option');
                option.value = congregation.name;
                option.textContent = congregation.name;
                congregationSelect.appendChild(option);
            });
        }

        // Function to handle outline input
        function handleOutlineInput(value) {
            const outline = outlines.find(o => o.number.toString() === value);
            const talkTitleInput = document.getElementById('talkTitle');
            
            if (outline) {
                talkTitleInput.value = outline.title;
            } else {
                talkTitleInput.value = '';
            }
        }

        // Function to handle next outline search
        function handleNextOutlineSearch(value) {
            const outline = outlines.find(o => o.number === value);
            if (outline) {
                document.getElementById('nextOutlineNumber').value = outline.number;
                document.getElementById('nextTalkTitle').value = outline.title;
            }
        }

        // Function to handle congregation selection change
        function handleCongregationChange(value) {
            const congregationInput = document.getElementById('congregation');
            
            if (value === 'custom') {
                congregationInput.style.display = 'block';
                congregationInput.value = '';
                congregationInput.focus();
            } else {
                congregationInput.style.display = 'none';
                congregationInput.value = value || '';  // Handle empty selection
            }
        }

        // Function to handle outline search
        function handleOutlineSearch(value) {
            const outline = outlines.find(o => o.number === value);
            if (outline) {
                document.getElementById('outlineNumber').value = outline.number;
                document.getElementById('talkTitle').value = outline.title;
            }
        }

        // Load outlines and congregations when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            loadOutlines();
            loadCongregations();
        });
    </script>
</body>
</html> 